\hypertarget{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e}{}\doxysection{U\+A\+RT 패킷 송수신}
\label{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e}\index{UART 패킷 송수신@{UART 패킷 송수신}}
\doxysubsection*{함수}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e_ga9b8e356f7ac4e4ba929f0e782e50329e}{message\+Init}} (void)
\item 
void \mbox{\hyperlink{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e_ga4c554787dc5196e18c0d2f5eab6a5254}{put\+Byte\+To\+Buffer}} (volatile \mbox{\hyperlink{structuart_f_i_f_o___type_def}{uart\+F\+I\+F\+O\+\_\+\+Type\+Def}} $\ast$buffer, uint8\+\_\+t \mbox{\hyperlink{message_8c_a0523c05685d59544dca911cb6a3db77d}{ch}})
\begin{DoxyCompactList}\small\item\em U\+A\+RT 버퍼 1Byte 저장 \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e_gac6432ce1f2fa79fd11b6aee1254ed39c}{get\+Byte\+From\+Buffer}} (volatile \mbox{\hyperlink{structuart_f_i_f_o___type_def}{uart\+F\+I\+F\+O\+\_\+\+Type\+Def}} $\ast$buffer, uint8\+\_\+t $\ast$\mbox{\hyperlink{message_8c_a0523c05685d59544dca911cb6a3db77d}{ch}})
\begin{DoxyCompactList}\small\item\em Get the Byte From Buffer object \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e_ga3bf9e40b58d4b54c85623b74b27ba23d}{send\+Message}} (uint8\+\_\+t $\ast$data, uint8\+\_\+t len)
\begin{DoxyCompactList}\small\item\em R\+S485로 메시지 송신 \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e_gaf8775fb88222c3239809acee4b6fe538}{proc\+Message}} (void)
\begin{DoxyCompactList}\small\item\em 메시지 처리 예제 \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{상세한 설명}


\doxysubsection{함수 문서화}
\mbox{\Hypertarget{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e_gac6432ce1f2fa79fd11b6aee1254ed39c}\label{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e_gac6432ce1f2fa79fd11b6aee1254ed39c}} 
\index{UART 패킷 송수신@{UART 패킷 송수신}!getByteFromBuffer@{getByteFromBuffer}}
\index{getByteFromBuffer@{getByteFromBuffer}!UART 패킷 송수신@{UART 패킷 송수신}}
\doxysubsubsection{\texorpdfstring{getByteFromBuffer()}{getByteFromBuffer()}}
{\footnotesize\ttfamily bool get\+Byte\+From\+Buffer (\begin{DoxyParamCaption}\item[{volatile \mbox{\hyperlink{structuart_f_i_f_o___type_def}{uart\+F\+I\+F\+O\+\_\+\+Type\+Def}} $\ast$}]{buffer,  }\item[{uint8\+\_\+t $\ast$}]{ch }\end{DoxyParamCaption})}



Get the Byte From Buffer object 


\begin{DoxyParams}{매개변수}
{\em \mbox{\hyperlink{structuart_f_i_f_o___type_def}{uart\+F\+I\+F\+O\+\_\+\+Type\+Def}}} & \+: 버퍼 구조체 포인터 \\
\hline
{\em ch} & \+: 리턴받을 1byte 포인터 \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{반환값}
true \+: 데이터가 있으면 

false \+: 버퍼에 데이터가 없으면 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{84 \{}
\DoxyCodeLine{85   \textcolor{keywordtype}{bool} error;}
\DoxyCodeLine{86   \textcolor{keywordflow}{if} (buffer-\/>count != 0U) \textcolor{comment}{/* 버퍼에 데이터가 있으면 */}}
\DoxyCodeLine{87   \{}
\DoxyCodeLine{88     *\mbox{\hyperlink{message_8c_a0523c05685d59544dca911cb6a3db77d}{ch}} = buffer-\/>buff[buffer-\/>out]; \textcolor{comment}{/* 버퍼에서 1Byte 읽음 */}}
\DoxyCodeLine{89     buffer-\/>buff[buffer-\/>out++] = 0;}
\DoxyCodeLine{90     buffer-\/>count-\/-\/;                     \textcolor{comment}{/* 버퍼에 저장된 데이터 갯수 1 감소 */}}
\DoxyCodeLine{91     \textcolor{keywordflow}{if} (buffer-\/>out == \mbox{\hyperlink{message_8h_a0d57378e32bf8278011460740bc29f7f}{UART\_BUFFER\_SIZE}}) \textcolor{comment}{/* 끝 인덱스가 버퍼의 끝이면 */}}
\DoxyCodeLine{92     \{}
\DoxyCodeLine{93       buffer-\/>out = 0; \textcolor{comment}{/* 끝 인덱스를 0부터 다시 시작 */}}
\DoxyCodeLine{94     \}}
\DoxyCodeLine{95     error = \textcolor{keyword}{true};}
\DoxyCodeLine{96   \}}
\DoxyCodeLine{97   \textcolor{keywordflow}{else}}
\DoxyCodeLine{98   \{}
\DoxyCodeLine{99     error = \textcolor{keyword}{false}; \textcolor{comment}{/* 버퍼에 데이터가 없으면 false 리턴 */}}
\DoxyCodeLine{100   \}}
\DoxyCodeLine{101   \textcolor{keywordflow}{return} error;}
\DoxyCodeLine{102 \}}

\end{DoxyCode}
\mbox{\Hypertarget{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e_ga9b8e356f7ac4e4ba929f0e782e50329e}\label{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e_ga9b8e356f7ac4e4ba929f0e782e50329e}} 
\index{UART 패킷 송수신@{UART 패킷 송수신}!messageInit@{messageInit}}
\index{messageInit@{messageInit}!UART 패킷 송수신@{UART 패킷 송수신}}
\doxysubsubsection{\texorpdfstring{messageInit()}{messageInit()}}
{\footnotesize\ttfamily void message\+Init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{51 \{}
\DoxyCodeLine{52   HAL\_UART\_Receive\_DMA(\&huart3, (uint8\_t *)\&\mbox{\hyperlink{message_8c_aed1d3430d79be36c0a24bc410a75fd78}{uart3Buffer}}.\mbox{\hyperlink{structuart_f_i_f_o___type_def_acbcf5f8de7895ca456bb39fbcccde1d1}{ch}}, 1); \textcolor{comment}{/* UART3(RS485) DMA 인터럽트 시작 */}}
\DoxyCodeLine{53   HAL\_UART\_Receive\_DMA(\&huart1, (uint8\_t *)\&\mbox{\hyperlink{message_8c_ac8100bb141db19912399a3c1bd92b2ed}{uart1Buffer}}.\mbox{\hyperlink{structuart_f_i_f_o___type_def_acbcf5f8de7895ca456bb39fbcccde1d1}{ch}}, 1);}
\DoxyCodeLine{54 \}}

\end{DoxyCode}
\mbox{\Hypertarget{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e_gaf8775fb88222c3239809acee4b6fe538}\label{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e_gaf8775fb88222c3239809acee4b6fe538}} 
\index{UART 패킷 송수신@{UART 패킷 송수신}!procMessage@{procMessage}}
\index{procMessage@{procMessage}!UART 패킷 송수신@{UART 패킷 송수신}}
\doxysubsubsection{\texorpdfstring{procMessage()}{procMessage()}}
{\footnotesize\ttfamily void proc\+Message (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



메시지 처리 예제 


\begin{DoxyCode}{0}
\DoxyCodeLine{120 \{}
\DoxyCodeLine{121   \textcolor{comment}{/* UART3(RS485) 데이터가 uart3Buffer 버퍼에 있으면 아스키 값 출력 */}}
\DoxyCodeLine{122   uint8\_t rxCh = 0;}
\DoxyCodeLine{123   \textcolor{keywordflow}{while} (\mbox{\hyperlink{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e_gac6432ce1f2fa79fd11b6aee1254ed39c}{getByteFromBuffer}}(\&\mbox{\hyperlink{message_8c_aed1d3430d79be36c0a24bc410a75fd78}{uart3Buffer}}, \&rxCh) == \textcolor{keyword}{true})}
\DoxyCodeLine{124   \{}
\DoxyCodeLine{125     printf(\textcolor{stringliteral}{"\%c"},rxCh);}
\DoxyCodeLine{126   \}}
\DoxyCodeLine{127 }
\DoxyCodeLine{128   \textcolor{comment}{/* OK 메시지 송신 */}}
\DoxyCodeLine{129   uint8\_t *txData = \textcolor{stringliteral}{"OK\(\backslash\)r\(\backslash\)n"};}
\DoxyCodeLine{130   \mbox{\hyperlink{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e_ga3bf9e40b58d4b54c85623b74b27ba23d}{sendMessage}}(txData,4);}
\DoxyCodeLine{131 \}}

\end{DoxyCode}
\mbox{\Hypertarget{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e_ga4c554787dc5196e18c0d2f5eab6a5254}\label{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e_ga4c554787dc5196e18c0d2f5eab6a5254}} 
\index{UART 패킷 송수신@{UART 패킷 송수신}!putByteToBuffer@{putByteToBuffer}}
\index{putByteToBuffer@{putByteToBuffer}!UART 패킷 송수신@{UART 패킷 송수신}}
\doxysubsubsection{\texorpdfstring{putByteToBuffer()}{putByteToBuffer()}}
{\footnotesize\ttfamily void put\+Byte\+To\+Buffer (\begin{DoxyParamCaption}\item[{volatile \mbox{\hyperlink{structuart_f_i_f_o___type_def}{uart\+F\+I\+F\+O\+\_\+\+Type\+Def}} $\ast$}]{buffer,  }\item[{uint8\+\_\+t}]{ch }\end{DoxyParamCaption})}



U\+A\+RT 버퍼 1Byte 저장 


\begin{DoxyParams}{매개변수}
{\em \mbox{\hyperlink{structuart_f_i_f_o___type_def}{uart\+F\+I\+F\+O\+\_\+\+Type\+Def}}} & \+: 버퍼 구조체 포인터 \\
\hline
{\em ch} & \+: 버퍼에 저장 할 값 \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{63 \{}
\DoxyCodeLine{64   \textcolor{keywordflow}{if} (buffer-\/>count != \mbox{\hyperlink{message_8h_a0d57378e32bf8278011460740bc29f7f}{UART\_BUFFER\_SIZE}}) \textcolor{comment}{/* 데이터가 버퍼에 가득 찼으면 ERROR 리턴 */}}
\DoxyCodeLine{65   \{}
\DoxyCodeLine{66     buffer-\/>buff[buffer-\/>in++] = \mbox{\hyperlink{message_8c_a0523c05685d59544dca911cb6a3db77d}{ch}};    \textcolor{comment}{/* 버퍼에 1Byte 저장 */}}
\DoxyCodeLine{67     buffer-\/>count++;                    \textcolor{comment}{/* 버퍼에 저장된 갯수 1 증가 */}}
\DoxyCodeLine{68     \textcolor{keywordflow}{if} (buffer-\/>in == \mbox{\hyperlink{message_8h_a0d57378e32bf8278011460740bc29f7f}{UART\_BUFFER\_SIZE}}) \textcolor{comment}{/* 시작 인덱스가 버퍼의 끝이면 */}}
\DoxyCodeLine{69     \{}
\DoxyCodeLine{70       buffer-\/>in = 0; \textcolor{comment}{/* 시작 인덱스를 0부터 다시 시작 */}}
\DoxyCodeLine{71     \}}
\DoxyCodeLine{72   \}}
\DoxyCodeLine{73 \}}

\end{DoxyCode}
\mbox{\Hypertarget{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e_ga3bf9e40b58d4b54c85623b74b27ba23d}\label{group___xEC_x83_x9D_xED_x99_x9C_xEC_xA0_x95_xEB_xB3_xB4_xEA_xB8_xB0___m_e_s_s_a_g_e_ga3bf9e40b58d4b54c85623b74b27ba23d}} 
\index{UART 패킷 송수신@{UART 패킷 송수신}!sendMessage@{sendMessage}}
\index{sendMessage@{sendMessage}!UART 패킷 송수신@{UART 패킷 송수신}}
\doxysubsubsection{\texorpdfstring{sendMessage()}{sendMessage()}}
{\footnotesize\ttfamily uint8\+\_\+t send\+Message (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{data,  }\item[{uint8\+\_\+t}]{len }\end{DoxyParamCaption})}



R\+S485로 메시지 송신 


\begin{DoxyParams}{매개변수}
{\em data} & \+: 전송할 데이터 포인터 \\
\hline
{\em len} & \+: 메시지 길이 0$\sim$255 \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{반환값}
uint8\+\_\+t \+: 0 OK, 1 E\+R\+R\+OR, 2 B\+U\+SY, 3 Timeout 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{111 \{}
\DoxyCodeLine{112   \textcolor{keywordflow}{return} (uint8\_t)HAL\_UART\_Transmit(\&huart3, data, len, 0xFFFF);}
\DoxyCodeLine{113 \}}

\end{DoxyCode}
